<!DOCTYPE html>
<html lang="id" translate="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes, viewport-fit=cover">
    <meta name="google" content="notranslate">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="theme-color" content="#ff9f1c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>HSK 2 ¬∑ Èó®ÂºÄÁùÄÂë¢ ¬∑  Kartun Versi 2</title>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        input, textarea, .btn-opsi, .btn-pilih, .btn-bs, .btn-kata,
        .pair-item-left, .pair-item-right, .btn-utama, .btn-review {
            -webkit-user-select: auto;
            -khtml-user-select: auto;
            -moz-user-select: auto;
            -ms-user-select: auto;
            user-select: auto;
        }
        body {
            -webkit-touch-callout: none;
            background: linear-gradient(135deg, #f9d6b3 0%, #b5e6c3 100%);
            background-attachment: fixed;
            padding: 30px 20px;
            color: #2d3e50;
            font-family: 'Comic Neue', cursive, sans-serif;
            margin: 0;
            min-height: 100vh;
        }
        .header-kartun {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: linear-gradient(135deg, #ff9f1c, #ff6b6b);
            padding: 18px 30px;
            border-radius: 80px 20px 80px 20px;
            box-shadow: 0 10px 0 #c44569, 0 8px 20px rgba(0,0,0,0.2);
            margin-bottom: 20px;
            border: 4px solid #fff;
            color: #fff;
            flex-wrap: wrap;
        }
        .header-kartun h1 {
            font-size: 2.2rem;
            font-weight: 700;
            text-shadow: 3px 3px 0 #c44569;
            letter-spacing: 2px;
            margin: 0;
        }
        .header-kartun i {
            font-size: 3rem;
            color: #fff;
            text-shadow: 2px 2px 0 #c44569;
        }
        .timer-container {
            background: #5d9b9b;
            border-radius: 60px 10px 60px 10px;
            padding: 15px 30px;
            margin: 0 0 30px 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border: 5px solid #ffd966;
            color: white;
            font-weight: 700;
            font-size: 1.8rem;
            box-shadow: 8px 8px 0 #2d6a6a;
            flex-wrap: wrap;
        }
        .timer-box {
            background: #ff6b6b;
            padding: 10px 25px;
            border-radius: 50px;
            border: 3px solid #ffe066;
            color: white;
            font-family: monospace;
            letter-spacing: 5px;
        }
        .section-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(8px);
            border: 5px solid #6c5ce7;
            border-radius: 60px 20px 60px 20px;
            box-shadow: 12px 12px 0 #4834d4, 0 12px 25px rgba(0,0,0,0.2);
            padding: 30px 25px;
            margin-bottom: 50px;
        }
        .section-title {
            background: linear-gradient(145deg, #f368e0, #ff9f43);
            display: inline-block;
            padding: 12px 35px;
            border-radius: 40px 10px 40px 10px;
            color: white;
            font-weight: 700;
            font-size: 1.7rem;
            margin-top: -60px;
            margin-bottom: 25px;
            border: 4px solid #fffa65;
            box-shadow: 6px 6px 0 #aa3e3e;
            text-shadow: 2px 2px 0 #8b4c4c;
        }
        .section-title i {
            margin-right: 15px;
            color: #fffa65;
        }
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        .soal-item {
            background: #fff9e6;
            padding: 18px 20px;
            border-radius: 30px 10px 30px 10px;
            border: 3px solid #ffb8b8;
            box-shadow: 7px 7px 0 #ff6b6b;
            margin-bottom: 20px;
        }
        .benar-salah-container {
            display: flex;
            gap: 20px;
            margin-top: 12px;
            flex-wrap: wrap;
        }
        .btn-bs {
            background: #ffeaa7;
            border: 3px solid #fdcb6e;
            padding: 10px 25px;
            border-radius: 40px;
            font-weight: 700;
            cursor: pointer;
            transition: 0.1s;
            box-shadow: 4px 4px 0 #e17055;
            color: #2d3436;
        }
        .btn-bs.selected { background: #a29bfe; border-color: #6c5ce7; box-shadow: 2px 2px 0 #4834d4; color: white; }
        .btn-bs.benar { background: #55efc4 !important; border-color: #00b894 !important; color: white; box-shadow: 2px 2px 0 #006266; }
        .btn-bs.salah { background: #ff7675 !important; border-color: #d63031 !important; color: white; box-shadow: 2px 2px 0 #b22222; }
        .dialog-box {
            background: #fdffb8;
            padding: 12px;
            border-radius: 20px;
            border: 3px solid #ffb347;
            margin-bottom: 12px;
        }
        .dialog-line { font-size: 1.2rem; margin: 5px 0; font-weight: 600; }
        .pertanyaan { font-size: 1.2rem; font-weight: 700; margin: 12px 0 8px; color: #2c3e50; }
        .opsi-container { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 12px; }
        .btn-opsi {
            background: #c7ecee; border: 3px solid #22a6b3; padding: 10px 15px; border-radius: 30px;
            font-weight: 600; cursor: pointer; transition: 0.1s; box-shadow: 3px 3px 0 #1e7a8a; text-align: left;
            color: #1e272e;
        }
        .btn-opsi.selected { background: #f6e58d; border-color: #f79f1f; box-shadow: 2px 2px 0 #d35400; color: #2d3436; }
        .btn-opsi.benar { background: #6ab04c !important; border-color: #2e7d32 !important; color: white; box-shadow: 2px 2px 0 #1b5e20; }
        .btn-opsi.salah { background: #e66767 !important; border-color: #c0392b !important; color: white; box-shadow: 2px 2px 0 #a52626; }
        .btn-pilih {
            background: #fab1a0; border: 3px solid #e17055; padding: 12px 25px; border-radius: 30px;
            font-weight: 700; cursor: pointer; transition: 0.1s; box-shadow: 4px 4px 0 #b45f4b; color: #2d3436;
        }
        .btn-pilih.selected { background: #74b9ff; border-color: #0984e3; box-shadow: 2px 2px 0 #0652a5; color: white; }
        .btn-pilih.benar { background: #6ab04c !important; border-color: #2e7d32 !important; color: white; box-shadow: 2px 2px 0 #1b5e20; }
        .btn-pilih.salah { background: #e66767 !important; border-color: #c0392b !important; color: white; box-shadow: 2px 2px 0 #a52626; }
        .input-kotak {
            background: white; border: 4px solid #f9ca24; border-radius: 20px; padding: 10px 20px;
            font-size: 1.5rem; text-align: center; width: 100%; letter-spacing: 8px;
            font-weight: 600; color: #1e3a5f; box-shadow: inset 3px 3px 0 #f6e58d;
        }
        .input-kotak.benar { background: #a5d6a5; border-color: #1f7a1f; }
        .input-kotak.salah { background: #ffab91; border-color: #b71c1c; }
        .bank-kata-container {
            background: #f9e79f; border: 5px dashed #e67e22; border-radius: 50px; 
            padding: 20px; margin-bottom: 30px; display: flex; flex-wrap: wrap; gap: 12px;
            align-items: center; justify-content: center;
        }
        .btn-kata {
            background: #f8c291; border: 3px solid #e07a5f; padding: 10px 25px;
            border-radius: 40px; font-size: 1.4rem; font-weight: 700; color: #3b2e24;
            box-shadow: 5px 5px 0 #b66b4b; cursor: pointer; transition: 0.05s;
        }
        .btn-kata:active { transform: scale(0.95); box-shadow: 2px 2px 0 #b66b4b; }
        .soal-isian {
            background: #dff9fb; border: 4px solid #22a6b3; border-radius: 30px 10px 30px 10px;
            padding: 20px; box-shadow: 8px 8px 0 #1e7a8a;
        }
        .soal-isian p { font-size: 1.3rem; font-weight: 600; margin-bottom: 15px; }
        .pasangan-container { display: flex; justify-content: space-between; gap: 30px; margin-top: 20px; }
        .kolom-pasangan { 
            background: #bae1ff; border-radius: 25px; padding: 20px; flex: 1; border: 4px solid #5d9b9b; 
            min-height: 350px; position: relative;
        }
        .pair-item-left, .pair-item-right {
            background: #fff3cd; padding: 15px 20px; margin: 12px 0;
            border-radius: 40px 8px 40px 8px; border: 3px solid #ffa07a;
            font-weight: 600; box-shadow: 5px 5px 0 #d47b5a; cursor: pointer;
            transition: 0.1s; position: relative;
        }
        .pair-item-left {
            cursor: grab;
            touch-action: none;
            -webkit-touch-action: none;
        }
        .pair-item-left.dragging {
            opacity: 0.6;
            box-shadow: 0 0 0 3px #ff6b6b;
            cursor: grabbing;
        }
        .pair-item-left.paired, .pair-item-right.paired { 
            background: #c3e6cb !important; 
            border-color: #28a745 !important; 
            box-shadow: 2px 2px 0 #1e7e34;
            color: #155724;
        }
        .pair-item-left.benar, .pair-item-right.benar { background: #a5d6a5 !important; border-color: #1f7a1f !important; }
        .pair-item-left.salah, .pair-item-right.salah { background: #ffab91 !important; border-color: #b71c1c !important; }
        .drag-ghost {
            position: fixed; 
            background: #ffcb05; 
            padding: 15px 25px;
            border-radius: 40px 8px 40px 8px; 
            border: 3px solid #2d70b0;
            font-weight: 700; 
            color: #1f3c7a; 
            box-shadow: 8px 8px 0 #1f4f8a;
            pointer-events: none; 
            z-index: 9999; 
            transform: translate(-50%, -50%);
            opacity: 0.9; 
            white-space: nowrap;
            display: none;
        }
        .btn-utama {
            background: #ff6b6b; border: none; color: white; padding: 20px 70px;
            font-size: 2rem; border-radius: 80px; font-weight: 700; border-bottom: 10px solid #c44569;
            margin: 40px auto; cursor: pointer; display: block; transition: 0.05s linear;
            box-shadow: 0 10px 0 #8b4c4c;
        }
        .btn-utama:active { border-bottom-width: 4px; transform: translateY(6px); }
        .btn-review {
            background: #6c5ce7; border: none; color: white; padding: 15px 50px;
            font-size: 1.8rem; border-radius: 60px; font-weight: 700; border-bottom: 8px solid #4834d4;
            margin: 20px auto; cursor: pointer; display: inline-block; transition: 0.05s linear;
            box-shadow: 0 8px 0 #2d2b6b;
        }
        .btn-review:active { border-bottom-width: 3px; transform: translateY(5px); }
        .laporan-akhir {
            background: #2d3e50; color: white; padding: 30px; border-radius: 60px 20px 60px 20px;
            margin-top: 30px; font-size: 1.5rem; border: 6px solid #f9ca24; text-align: center;
        }
        footer { text-align: center; margin-top: 40px; font-size: 1.3rem; color: #2d3e50; font-weight: 700; }
        @media (max-width: 900px) {
            .grid-2 { grid-template-columns: 1fr; }
            .header-kartun h1 { font-size: 1.8rem; }
            .timer-container { font-size: 1.4rem; }
            .timer-box { padding: 8px 20px; }
            .section-title { font-size: 1.4rem; padding: 10px 25px; }
        }
        @media (max-width: 480px) {
            body { padding: 20px 10px; }
            .btn-utama { padding: 15px 30px; font-size: 1.6rem; }
        }
    </style>
</head>
<body oncontextmenu="return false;" oncopy="return false;" oncut="return false;" onselectstart="return false;" ondragstart="return false;">

    <div class="header-kartun">
        <i class="fas fa-paw"></i>
        <h1>‚ö° HSK 2 ¬∑ Èó®ÂºÄÁùÄÂë¢ ¬∑  Versi 2 ‚ö°</h1>
        <i class="fas fa-bolt"></i>
    </div>

    <div class="timer-container">
        <span><i class="fas fa-hourglass-half"></i> Sisa Waktu</span>
        <span class="timer-box" id="timerDisplay">56:00</span>
    </div>

    <p style="text-align: center; font-size: 1.6rem; margin-bottom: 20px; font-weight: 700; background: white; display: inline-block; padding: 10px 35px; border-radius: 40px; border: 4px solid #ff6b6b;">‚ú® 70 Soal Baru ¬∑ Pelajaran 13 ‚ú®</p>

    <!-- ===== 1. Âà§Êñ≠ÂØπÈîô (10) ===== -->
    <div class="section-card">
        <div class="section-title"><i class="fas fa-check-circle"></i> Âà§Êñ≠ÂØπÈîô ¬∑ 10</div>
        <div class="grid-2" id="benarSalahContainer"></div>
    </div>

    <!-- ===== 2. LISTENING (10) ===== -->
    <div class="section-card">
        <div class="section-title"><i class="fas fa-headphones-alt"></i> Âê¨ÂäõÁâπËÆ≠ ¬∑ 10</div>
        <div class="grid-2" id="listening-soal"></div>
    </div>

    <!-- ===== 3. PILIHAN GANDA (10) ===== -->
    <div class="section-card">
        <div class="section-title"><i class="fas fa-question-circle"></i>  PILIHAN GANDA ¬∑ 10</div>
        <div id="pilihan-ganda-container"></div>
    </div>

    <!-- ===== 4. ISIAN HANZI (10) ===== -->
    <div class="section-card">
        <div class="section-title"><i class="fas fa-pencil-alt"></i>  ISIAN HANZI ¬∑ 10</div>
        <div id="bankKataIsian" class="bank-kata-container"></div>
        <div id="soal-isian-container" class="grid-2"></div>
    </div>

    <!-- ===== 5. MENGETIK HANZI (PINYIN) ===== -->
    <div class="section-card">
        <div class="section-title"><i class="fas fa-keyboard"></i>  TULIS HANZI (pinyin) ¬∑ 10</div>
        <div id="ketik-hanzi-grid" class="grid-2"></div>
    </div>

    <!-- ===== 6. INDONESIA ‚Üí HANZI ===== -->
    <div class="section-card">
        <div class="section-title"><i class="fas fa-language"></i>  INDONESIA ‚Üí HANZI ¬∑ 10</div>
        <div id="indo-hanzi-grid" class="grid-2"></div>
    </div>

    <!-- ===== 7. MENJODOHKAN DRAG & DROP (2 set) ===== -->
    <div class="section-card">
        <div class="section-title"><i class="fas fa-link"></i>  JODOHKAN ¬∑ set 1 (5) ‚Äî tarik kiri ke kanan</div>
        <div id="pasangan-set1" class="pasangan-container"></div>
        <div style="margin: 30px 0;"></div>
        <div class="section-title"><i class="fas fa-link"></i>  JODOHKAN ¬∑ set 2 (5) ‚Äî tarik kiri ke kanan</div>
        <div id="pasangan-set2" class="pasangan-container"></div>
    </div>

    <button id="submitGlobalBtn" class="btn-utama"><i class="fas fa-paper-plane"></i> KIRIM SEMUA JAWABAN</button>
    <div id="laporanGlobal" class="laporan-akhir" style="display: none;"></div>
    <footer><i class="fas fa-paw"></i>  HSK 2 ¬∑ Á¨¨ÂçÅ‰∏âËØæ ¬∑ Èó®ÂºÄÁùÄÂë¢ ¬∑ Versi 2 <i class="fas fa-paw"></i></footer>

    <div id="dragGhost" class="drag-ghost"></div>

    <script>
        (function() {
            // ==================== FUNGSI ACAK ====================
            function shuffleArray(arr) {
                for (let i = arr.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [arr[i], arr[j]] = [arr[j], arr[i]];
                }
                return arr;
            }

            // ========== 1. Âà§Êñ≠ÂØπÈîô (10 soal baru) ==========
            const bsDataOriginal = [
                { kalimat: "ÊòéÂ§©ÊúâÂ§ßÈõ™Ôºå‰Ω†Ë¶ÅÂ§öÁ©øË°£Êúç„ÄÇ", pernyataan: "ÊòéÂ§©Â§©Ê∞îÂæàÁÉ≠Ôºå‰∏çÁî®Â§öÁ©øË°£Êúç„ÄÇ", jawaban: "S" },
                { kalimat: "Êò®Â§©Èõ∂‰∏ã‰∫îÂ∫¶ÔºåÈùûÂ∏∏ÂÜ∑„ÄÇ", pernyataan: "Êò®Â§©Èõ∂‰∏ã‰∫îÂ∫¶ÔºåÂæàÂÜ∑„ÄÇ", jawaban: "B" },
                { kalimat: "Â≠©Â≠êÂ∑≤ÁªèÂÖ´Â≤Å‰∫ÜÔºå‰ºöËá™Â∑±Á©øË°£Êúç„ÄÇ", pernyataan: "Â≠©Â≠êËøò‰∏ç‰ºöÁ©øË°£Êúç„ÄÇ", jawaban: "S" },
                { kalimat: "Áà∏Áà∏‰∏ãÈ£ûÊú∫ÂêéÂÖàÂõûÂÆ∂‰∫ÜÔºåÁÑ∂ÂêéÂéªÂÖ¨Âè∏„ÄÇ", pernyataan: "Áà∏Áà∏ÂÖàÂõûÂÆ∂ÂÜçÂéªÂÖ¨Âè∏„ÄÇ", jawaban: "S" },
                { kalimat: "ÊàëÂÆ∂Á¶ªÂ≠¶Ê†°ÂæàËøëÔºåËµ∞Ë∑Ø‰∫îÂàÜÈíüÂ∞±Âà∞„ÄÇ", pernyataan: "ÊàëÂÆ∂Á¶ªÂ≠¶Ê†°ÂæàËøú„ÄÇ", jawaban: "S" },
                { kalimat: "ËÄÉËØïÁöÑÊó∂ÂÄô‰Ω†‰ª¨ÂèØ‰ª•ÂùêÂú®‰∏ÄËµ∑„ÄÇ", pernyataan: "ËÄÉËØïÁöÑÊó∂ÂÄôÂèØ‰ª•ÂùêÂæóÂæàËøë„ÄÇ", jawaban: "S" },
                { kalimat: "Èó®Ê≤°ÂºÄÁùÄÔºåËØ∑Êï≤Èó®„ÄÇ", pernyataan: "Èó®ÂºÄÁùÄÂë¢ÔºåËØ∑Ëøõ„ÄÇ", jawaban: "S" },
                { kalimat: "ÈÇ£‰∏™ÈïøÁùÄÂ§ßÁúºÁùõÁöÑÂ•≥Â≠©Âè´Êù®Á¨ëÁ¨ë„ÄÇ", pernyataan: "ÈÇ£‰∏™Â•≥Â≠©Âè´Êù®Á¨ëÁ¨ë„ÄÇ", jawaban: "B" },
                { kalimat: "‰ªñÁöÑÂ•≥ÊúãÂèã‰ª•ÂâçÊúâÁî∑ÊúãÂèãÔºåÁé∞Âú®ÊòØÂâçÁî∑Âèã„ÄÇ", pernyataan: "Â•πÁöÑÂâçÁî∑ÂèãÊòØÁé∞Âú®ÁöÑÁî∑ÊúãÂèã„ÄÇ", jawaban: "S" },
                { kalimat: "‰ªéËøôÂÑø‰∏ÄÁõ¥ÂæÄÂâçËµ∞ÔºåÂà∞‰∫ÜË∑ØÂè£ÂæÄÂ∑¶Ëµ∞Â∞±ÊòØÂÆæÈ¶Ü„ÄÇ", pernyataan: "ÂÆæÈ¶ÜÂú®Ë∑ØÂè£Â∑¶Ëæπ„ÄÇ", jawaban: "B" }
            ];
            let bsData = shuffleArray([...bsDataOriginal]);
            let bsUserAnswers = new Array(10).fill(null);
            const bsContainer = document.getElementById('benarSalahContainer');
            bsContainer.innerHTML = bsData.map((item, idx) => {
                return `<div class="soal-item" data-bs="${idx}">
                    <p style="font-size:1.2rem; background:#fce7b2; padding:10px; border-radius:20px;"><i class="fas fa-quote-left"></i> ${item.kalimat}</p>
                    <p style="font-size:1.1rem; font-weight:600; margin-top:12px;">üìå Pernyataan: ${item.pernyataan}</p>
                    <div class="benar-salah-container" id="bs-${idx}">
                        <span class="btn-bs" onclick="pilihBS(${idx}, 'B')" id="bs-${idx}-B"><i class="fas fa-check-circle"></i> BENAR</span>
                        <span class="btn-bs" onclick="pilihBS(${idx}, 'S')" id="bs-${idx}-S"><i class="fas fa-times-circle"></i> SALAH</span>
                    </div>
                </div>`;
            }).join('');
            window.pilihBS = function(idx, pilih) {
                bsUserAnswers[idx] = pilih;
                document.getElementById(`bs-${idx}-B`).classList.remove('selected');
                document.getElementById(`bs-${idx}-S`).classList.remove('selected');
                document.getElementById(`bs-${idx}-${pilih}`).classList.add('selected');
            };

            // ========== 2. LISTENING (10 percakapan baru) ==========
            const listeningOriginal = [
                { percakapan: ["Â•≥ÔºöÊòéÂ§©Â§©Ê∞îÊÄé‰πàÊ†∑Ôºü", "Áî∑ÔºöÂ§©Ê∞îÈ¢ÑÊä•ËØ¥ÊúâÂ§ßÈõ™ÔºåË¶ÅÂ§öÁ©øË°£Êúç„ÄÇ"], pertanyaan: "ÊòéÂ§©Â§©Ê∞îÊÄé‰πàÊ†∑Ôºü", opsi: ["A. ‰∏ãÈõ®", "B. ‰∏ãÈõ™", "C. Êô¥Â§©", "D. ÂàÆÈ£é"], jawaban: "B" },
                { percakapan: ["Áî∑ÔºöÊò®Â§©ÂæàÂÜ∑ÔºåÂ§ñËæπÂè™ÊúâÈõ∂Â∫¶„ÄÇ", "Â•≥Ôºö‰ªäÂ§©Âë¢Ôºü", "Áî∑Ôºö‰ªäÂ§©Èõ∂‰∏ä‰∫îÂ∫¶„ÄÇ"], pertanyaan: "‰ªäÂ§©Â§öÂ∞ëÂ∫¶Ôºü", opsi: ["A. Èõ∂Â∫¶", "B. Èõ∂‰∏ä‰∫îÂ∫¶", "C. Èõ∂‰∏ã‰∫îÂ∫¶", "D. ÂçÅÂ∫¶"], jawaban: "B" },
                { percakapan: ["Â•≥Ôºö‰Ω†Á©øÂæóÂ§™Â∞ë‰∫ÜÔºå‰∏çÂÜ∑ÂêóÔºü", "Áî∑Ôºö‰∏çÂÜ∑ÔºåÊàëË∫´‰ΩìÂ•Ω„ÄÇ"], pertanyaan: "Áî∑ÁöÑÁ©øÂæóÊÄé‰πàÊ†∑Ôºü", opsi: ["A. Á©øÂæóÂæàÂ§ö", "B. Á©øÂæóÂ§™Â∞ë", "C. Á©øÂæóÊ≠£Â•Ω", "D. Á©øÂæóÂæàÂéö"], jawaban: "B" },
                { percakapan: ["Áî∑ÔºöËØ∑ÈóÆÔºåÂº†ËÄÅÂ∏àÂú®ÂäûÂÖ¨ÂÆ§ÂêóÔºü", "Â•≥ÔºöÈó®ÂºÄÁùÄÂë¢Ôºå‰ªñÂ∫îËØ•Âú®ÈáåÈù¢„ÄÇ"], pertanyaan: "Âº†ËÄÅÂ∏àÂú®ÂäûÂÖ¨ÂÆ§ÂêóÔºü", opsi: ["A. ‰∏çÂú®", "B. Âú®", "C. Âá∫Âéª‰∫Ü", "D. ‰∏çÁü•ÈÅì"], jawaban: "B" },
                { percakapan: ["Â•≥ÔºöÈÇ£‰∏™ÊâãÈáåÊãøÁùÄ‰π¶ÁöÑ‰∫∫ÊòØË∞ÅÔºü", "Áî∑ÔºöÊàë‰∏çËÆ§ËØÜÔºåÂèØËÉΩÊòØÊñ∞ÂêåÂ≠¶„ÄÇ"], pertanyaan: "ÈÇ£‰∏™ÊâãÈáåÊãøÁùÄ‰π¶ÁöÑ‰∫∫ÊòØË∞ÅÔºü", opsi: ["A. ËÄÅÂ∏à", "B. Êñ∞ÂêåÂ≠¶", "C. ‰∏çËÆ§ËØÜ", "D. Êù®Á¨ëÁ¨ë"], jawaban: "C" },
                { percakapan: ["Áî∑Ôºö‰Ω†ÂÆ∂Á¶ªÂ≠¶Ê†°ËøúÂêóÔºü", "Â•≥ÔºöÂæàËøëÔºåËµ∞Ë∑ØÂçÅÂàÜÈíüÂ∞±Âà∞„ÄÇ"], pertanyaan: "Â•≥ÁöÑÊÄé‰πàÂéªÂ≠¶Ê†°Ôºü", opsi: ["A. ÂùêËΩ¶", "B. Ëµ∞Ë∑Ø", "C. È™ëËΩ¶", "D. ÂùêÂú∞ÈìÅ"], jawaban: "B" },
                { percakapan: ["Â•≥ÔºöËÄÉËØïÁöÑÊó∂ÂÄôÂèØ‰ª•ÂùêÂú®‰∏ÄËµ∑ÂêóÔºü", "Áî∑Ôºö‰∏çÂèØ‰ª•Ôºå‰∏çËÉΩÂùêÂæóÂ§™Ëøë„ÄÇ"], pertanyaan: "ËÄÉËØïÁöÑÊó∂ÂÄôÂèØ‰ª•ÂùêÂæóÂæàËøëÂêóÔºü", opsi: ["A. ÂèØ‰ª•", "B. ‰∏çÂèØ‰ª•", "C. Èöè‰æø", "D. ‰∏çÁü•ÈÅì"], jawaban: "B" },
                { percakapan: ["Áî∑Ôºö‰ªñÂ•≥ÊúãÂèãÈïø‰ªÄ‰πàÊ†∑Ôºü", "Â•≥ÔºöÈïøÁùÄ‰∏§‰∏™Â§ßÁúºÁùõÔºåÂæàÁà±Á¨ë„ÄÇ"], pertanyaan: "‰ªñÂ•≥ÊúãÂèãÊúâ‰ªÄ‰πàÁâπÁÇπÔºü", opsi: ["A. Â∞èÁúºÁùõ", "B. Â§ßÁúºÁùõ", "C. ÈïøÂ§¥Âèë", "D. È´ò‰∏™Â≠ê"], jawaban: "B" },
                { percakapan: ["Â•≥ÔºöËØ∑ÈóÆÔºåÂéªÊñ∞‰∫¨ÂÆæÈ¶ÜÊÄé‰πàËµ∞Ôºü", "Áî∑Ôºö‰ªéËøôÂÑø‰∏ÄÁõ¥ÂæÄÂâçËµ∞ÔºåÂà∞‰∫ÜË∑ØÂè£ÂæÄÂè≥Ëµ∞„ÄÇ"], pertanyaan: "ÂéªÊñ∞‰∫¨ÂÆæÈ¶ÜÊÄé‰πàËµ∞Ôºü", opsi: ["A. ‰∏ÄÁõ¥Ëµ∞ÔºåË∑ØÂè£ÂæÄÂ∑¶", "B. ‰∏ÄÁõ¥Ëµ∞ÔºåË∑ØÂè£ÂæÄÂè≥", "C. ÂæÄÂ∑¶Ëµ∞", "D. ÂæÄÂè≥Ëµ∞"], jawaban: "B" },
                { percakapan: ["Áî∑Ôºö‰Ω†ËÆ§ËØÜÊù®Á¨ëÁ¨ëÂêóÔºü", "Â•≥ÔºöËÆ§ËØÜÔºåÂ•πÂßêÂßêÊòØÊàëÂêåÂ≠¶„ÄÇ"], pertanyaan: "Â•≥ÁöÑÊÄé‰πàËÆ§ËØÜÊù®Á¨ëÁ¨ëÔºü", opsi: ["A. ÂêåÁè≠ÂêåÂ≠¶", "B. ÂßêÂßêÁöÑÂêåÂ≠¶", "C. ÊúãÂèã‰ªãÁªç", "D. ÈÇªÂ±Ö"], jawaban: "B" }
            ];
            let listeningData = shuffleArray([...listeningOriginal]);
            let listeningUserAnswers = new Array(10).fill(null);
            const listeningDiv = document.getElementById('listening-soal');
            listeningDiv.innerHTML = listeningData.map((item, idx) => {
                let dialogHTML = '<div class="dialog-box">';
                item.percakapan.forEach(baris => dialogHTML += `<div class="dialog-line">${baris}</div>`);
                dialogHTML += '</div>';
                dialogHTML += `<div class="pertanyaan">${idx+1}. ${item.pertanyaan}</div><div class="opsi-container">`;
                item.opsi.forEach((opsi, opsiIdx) => {
                    const huruf = String.fromCharCode(65+opsiIdx);
                    dialogHTML += `<span class="btn-opsi" onclick="pilihListening(${idx}, '${huruf}')" id="listen-${idx}-${huruf}">${opsi}</span>`;
                });
                dialogHTML += '</div>';
                return `<div class="soal-item" data-listen="${idx}">${dialogHTML}</div>`;
            }).join('');
            window.pilihListening = function(idx, huruf) {
                listeningUserAnswers[idx] = huruf;
                document.querySelector(`[data-listen="${idx}"]`).querySelectorAll('.btn-opsi').forEach(btn => btn.classList.remove('selected'));
                document.getElementById(`listen-${idx}-${huruf}`).classList.add('selected');
            };

            // ========== 3. PILIHAN GANDA (10 soal baru) ==========
            const pgOriginal = [
                { soal: "‚ÄúÂ§ñÈù¢Âè™ÊúâÈõ∂Â∫¶‚Äù ÊòØ‰ªÄ‰πàÊÑèÊÄùÔºü", a: "Â§ñÈù¢ÂæàÁÉ≠", b: "Â§ñÈù¢ÂæàÂÜ∑", c: "Â§ñÈù¢‰∏ãÈõ®", d: "Â§ñÈù¢ÂàÆÈ£é", jawab: "b" },
                { soal: "‚ÄúÂø´ÁÇπÂÑøÁ©øÂ•ΩË°£Êúç‚Äù ‰∏≠ÁöÑ‚ÄúÂ•Ω‚ÄùË°®Á§∫‰ªÄ‰πàÔºü", a: "ÂÆåÊàê", b: "ÊºÇ‰∫Æ", c: "ÂèØ‰ª•", d: "ÂæàÂ•Ω", jawab: "a" },
                { soal: "‚Äú‰Ω†Á©øÂæóÂ§™Â∞ë‰∫Ü‚Äù ‰∏≠ÁöÑ‚ÄúÂ§™‚ÄùË°®Á§∫‰ªÄ‰πàÔºü", a: "ÈùûÂ∏∏", b: "Â§™‚Ä¶‰∫Ü" , c: "‰πü", d: "Âæà", jawab: "b" },
                { soal: "‚ÄúËøõÊàøÈó¥‚Äù ÁöÑ‚ÄúËøõ‚ÄùÊÑèÊÄùÊòØÔºü", a: "keluar", b: "masuk", c: "berjalan", d: "membuka", jawab: "b" },
                { soal: "‚ÄúÊàëÂÆ∂Á¶ªÂ≠¶Ê†°ÂæàËøë‚Äù ‰∏≠ÁöÑ‚ÄúÁ¶ª‚ÄùÊÑèÊÄùÊòØÔºü", a: "dari", b: "ke", c: "di", d: "dekat", jawab: "a" },
                { soal: "‚Äú‰ªñÂ∏åÊúõËÉΩ‰ΩèÂæóËøë‰∏ÄÁÇπÂÑø‚Äù ÊÑèÊÄùÊòØÔºü", a: "Â∏åÊúõ‰ΩèÂæóËøú", b: "Â∏åÊúõ‰ΩèÂæóÊõ¥Ëøë", c: "Â∏åÊúõÊê¨ÂÆ∂", d: "Â∏åÊúõËµ∞Ë∑Ø", jawab: "b" },
                { soal: "‚ÄúÂ•πÊâãÈáåÊãøÁùÄÈìÖÁ¨î‚Äù ‰∏≠ÁöÑ‚ÄúÁùÄ‚ÄùË°®Á§∫‰ªÄ‰πàÔºü", a: "Âä®‰ΩúËøõË°å", b: "Áä∂ÊÄÅÊåÅÁª≠", c: "ÂÆåÊàê", d: "Â∞ÜÊù•", jawab: "b" },
                { soal: "‚ÄúÂ•π‰∏çÊòØÊúâÁî∑ÊúãÂèãÂêóÔºü‚Äù ËøôÂè•ËØùÁöÑÊÑèÊÄùÊòØÔºü", a: "Â•πÊ≤°ÊúâÁî∑ÊúãÂèã", b: "Â•πÊúâÁî∑ÊúãÂèã", c: "Â•π‰ª•ÂâçÊúâÁî∑ÊúãÂèã", d: "Â•π‰∏çÂñúÊ¨¢Áî∑ÊúãÂèã", jawab: "b" },
                { soal: "‚ÄúÂâçÁî∑Âèã‚Äù ‰∏≠ÁöÑ‚ÄúÂâç‚ÄùÊòØ‰ªÄ‰πàÊÑèÊÄùÔºü", a: "‰ª•Ââç", b: "ÂâçÈù¢", c: "ÂâçÂêé", d: "ÂâçÂ§©", jawab: "a" },
                { soal: "‚ÄúÂæÄÂè≥Ëµ∞‚Äù ‰∏≠ÁöÑ‚ÄúÂæÄ‚ÄùÊÑèÊÄùÊòØÔºü", a: "ke arah", b: "dari", c: "di", d: "dengan", jawab: "a" }
            ];
            let pgData = shuffleArray([...pgOriginal]);
            let pgUserAnswers = new Array(10).fill(null);
            const pgContainer = document.getElementById('pilihan-ganda-container');
            pgContainer.innerHTML = pgData.map((item, idx) => {
                return `<div class="soal-item" data-pg="${idx}">
                    <p style="font-size:1.3rem;font-weight:700;">${idx+1}. ${item.soal}</p>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:15px;">
                        <span class="btn-pilih" onclick="pilihPG(${idx},'a',this)">A. ${item.a}</span>
                        <span class="btn-pilih" onclick="pilihPG(${idx},'b',this)">B. ${item.b}</span>
                        <span class="btn-pilih" onclick="pilihPG(${idx},'c',this)">C. ${item.c}</span>
                        <span class="btn-pilih" onclick="pilihPG(${idx},'d',this)">D. ${item.d}</span>
                    </div>
                </div>`;
            }).join('');
            window.pilihPG = function(idx, pilih, el) {
                pgUserAnswers[idx] = pilih;
                const parent = el.closest('.soal-item');
                parent.querySelectorAll('.btn-pilih').forEach(b => b.classList.remove('selected'));
                el.classList.add('selected');
            };

            // ========== 4. ISIAN HANZI (10 soal baru) ==========
            const isianSoalOriginal = [
                { kalimat: "ÊòéÂ§©Ë¶Å‰∏ãÂ§ß____ÔºåËÆ∞ÂæóÁ©øÂéöË°£Êúç„ÄÇ", jawab: "Èõ™" },
                { kalimat: "Êò®Â§©ÂæàÂÜ∑ÔºåÂ§ñÈù¢Âè™Êúâ____Â∫¶„ÄÇ", jawab: "Èõ∂" },
                { kalimat: "Âø´ÁÇπÂÑø____Â•ΩË°£ÊúçÔºåË¶ÅËøüÂà∞‰∫Ü„ÄÇ", jawab: "Á©ø" },
                { kalimat: "ËØ∑____ÔºåÈó®ÂºÄÁùÄÂë¢„ÄÇ", jawab: "Ëøõ" },
                { kalimat: "ÊàëÂÆ∂Á¶ªÂ≠¶Ê†°Âæà____ÔºåËµ∞Ë∑Ø‰∫îÂàÜÈíü„ÄÇ", jawab: "Ëøë" },
                { kalimat: "Â•πÊâã____ÊãøÁùÄ‰∏ÄÊú¨‰π¶„ÄÇ", jawab: "Èáå" },
                { kalimat: "ÈÇ£ÊîØÈìÖ____ÊòØË∞ÅÁöÑÔºü", jawab: "Á¨î" },
                { kalimat: "Â•πÈïøÁùÄ‰∏§‰∏™Â§ßÁúºÁùõÔºåÂæàÁà±____„ÄÇ", jawab: "Á¨ë" },
                { kalimat: "‰∏ÄÁõ¥ÂæÄÂ∑¶Ëµ∞Â∞±ÊòØ____È¶Ü„ÄÇ", jawab: "ÂÆæ" },
                { kalimat: "Âà∞‰∫ÜÂâçÈù¢ÁöÑË∑Ø____ÂÜçÂæÄÂè≥Ëµ∞„ÄÇ", jawab: "Âè£" }
            ];
            let isianSoal = shuffleArray([...isianSoalOriginal]);
            let bankKataIsian = ["Èõ™","Èõ∂","Á©ø","Ëøõ","Ëøë","Èáå","Á¨î","Á¨ë","ÂÆæ","Âè£","Êâã","Êãø","ÂæÄ","Èïø","Áõ¥"];
            let bankKataShuffled = shuffleArray([...bankKataIsian]);
            const bankContainer = document.getElementById('bankKataIsian');
            bankContainer.innerHTML = '';
            bankKataShuffled.forEach(kata => {
                const btn = document.createElement('span');
                btn.className = 'btn-kata';
                btn.textContent = kata;
                btn.setAttribute('data-kata', kata);
                btn.onclick = function() {
                    const active = document.activeElement;
                    if (active && active.classList.contains('input-isian')) {
                        active.value = kata;
                    } else {
                        alert('Klik pada kotak input yang ingin diisi terlebih dahulu.');
                    }
                };
                bankContainer.appendChild(btn);
            });
            const isianContainer = document.getElementById('soal-isian-container');
            isianContainer.innerHTML = '';
            isianSoal.forEach((item, idx) => {
                const div = document.createElement('div');
                div.className = 'soal-item soal-isian';
                div.setAttribute('data-isian', idx);
                div.innerHTML = `<p style="font-size:1.3rem;">${idx+1}. ${item.kalimat.replace('____','______')}</p>
                                <input class="input-kotak input-isian" type="text" id="isian-${idx}" data-jawaban="${item.jawab}" placeholder="ketik hanzi" autocomplete="off">`;
                isianContainer.appendChild(div);
            });

            // ========== 5. MENGETIK HANZI (pinyin baru) ==========
            const hanziOriginal = [
                { pinyin: "xuƒõ", arti: "salju", hanzi: "Èõ™" },
                { pinyin: "lƒõng", arti: "dingin", hanzi: "ÂÜ∑" },
                { pinyin: "r√®", arti: "panas", hanzi: "ÁÉ≠" },
                { pinyin: "j√¨n", arti: "dekat", hanzi: "Ëøë" },
                { pinyin: "yu«én", arti: "jauh", hanzi: "Ëøú" },
                { pinyin: "sh«íu", arti: "tangan", hanzi: "Êâã" },
                { pinyin: "n√°", arti: "memegang", hanzi: "Êãø" },
                { pinyin: "xi√†o", arti: "tertawa", hanzi: "Á¨ë" },
                { pinyin: "zh«éng", arti: "tumbuh", hanzi: "Èïø" },
                { pinyin: "l√π", arti: "jalan", hanzi: "Ë∑Ø" }
            ];
            let hanziFromPinyin = shuffleArray([...hanziOriginal]);
            const ketikGrid = document.getElementById('ketik-hanzi-grid');
            ketikGrid.innerHTML = hanziFromPinyin.map((item, idx) => {
                return `<div class="soal-item">
                    <p style="font-size:1.2rem;"><strong>${idx+1}. ${item.pinyin}</strong> (${item.arti})</p>
                    <input class="input-kotak" type="text" id="hanziInput${idx}" placeholder="ketik hanzi" autocomplete="off">
                </div>`;
            }).join('');

            // ========== 6. INDONESIA ‚Üí HANZI (baru) ==========
            const indoOriginal = [
                { arti: "salju kecil", hanzi: "Â∞èÈõ™" },
                { arti: "nol derajat", hanzi: "Èõ∂Â∫¶" },
                { arti: "di atas nol", hanzi: "Èõ∂‰∏ä" },
                { arti: "di bawah nol", hanzi: "Èõ∂‰∏ã" },
                { arti: "memakai sepatu", hanzi: "Á©øÈûã" },
                { arti: "masuk pintu", hanzi: "ËøõÈó®" },
                { arti: "sangat dekat", hanzi: "ÂæàËøë" },
                { arti: "terlalu dekat", hanzi: "Â§™Ëøë" },
                { arti: "di tangan", hanzi: "ÊâãÈáå" },
                { arti: "pensil", hanzi: "ÈìÖÁ¨î" }
            ];
            let indoToHanzi = shuffleArray([...indoOriginal]);
            const indoGrid = document.getElementById('indo-hanzi-grid');
            indoGrid.innerHTML = indoToHanzi.map((item, idx) => {
                return `<div class="soal-item">
                    <p style="font-size:1.3rem;"><strong>${idx+1}. ${item.arti}</strong></p>
                    <input class="input-kotak" type="text" id="indoInput${idx}" placeholder="tulis hanzi" autocomplete="off">
                </div>`;
            }).join('');

            // ========== 7. DRAG & DROP MATCHING (2 set baru) ==========
            const set1Pairs = [
                { left: "ÊòéÂ§©Â§©Ê∞îÊÄé‰πàÊ†∑", right: "ÊúâÂ§ßÈõ™ÔºåÂ§öÁ©øË°£Êúç" },
                { left: "Êò®Â§©Â§öÂ∞ëÂ∫¶", right: "Èõ∂‰∏ã‰∫îÂ∫¶" },
                { left: "‰Ω†Á©øÂæóÂ§™Â∞ë‰∫Ü", right: "ÊàëÈ©¨‰∏äÂ§öÁ©ø‰∏Ä‰ª∂" },
                { left: "Èó®ÂºÄÁùÄÂêó", right: "ÂºÄÁùÄÂë¢ÔºåËØ∑Ëøõ" },
                { left: "Âº†ÂÖàÁîüÂú®Âêó", right: "‰ªñ‰∏çÂú®ÔºåÂá∫Âéª‰∫Ü" }
            ];
            const set2Pairs = [
                { left: "ÈÇ£‰∏™Â•≥Â≠©ÊòØË∞Å", right: "Â•πÂè´Êù®Á¨ëÁ¨ë" },
                { left: "Â•πÊâãÈáåÊãøÁùÄ‰ªÄ‰πà", right: "‰∏ÄÊîØÈìÖÁ¨î" },
                { left: "‰ªñÂ•≥ÊúãÂèãÈïø‰ªÄ‰πàÊ†∑", right: "Â§ßÁúºÁùõÔºåÁà±Á¨ë" },
                { left: "ÂéªÂÆæÈ¶ÜÊÄé‰πàËµ∞", right: "‰∏ÄÁõ¥Ëµ∞ÔºåË∑ØÂè£ÂæÄÂè≥" },
                { left: "‰Ω†ÂÆ∂Á¶ªÂ≠¶Ê†°ËøúÂêó", right: "ÂæàËøëÔºåËµ∞Ë∑ØÂ∞±Âà∞" }
            ];
            let pairSet1 = {}; let pairSet2 = {};
            for (let i=0; i<5; i++) { pairSet1[i] = null; pairSet2[i] = null; }

            // Drag state
            let dragActive = false, draggedElement = null, draggedSet = null, draggedLeftIdx = null;
            let ghost = document.getElementById('dragGhost');

            function renderDragDropSet(setId, pairs, containerId) {
                let leftItems = pairs.map(p => p.left);
                let rightItems = pairs.map(p => p.right);
                leftItems = shuffleArray(leftItems);
                rightItems = shuffleArray(rightItems);
                const cont = document.getElementById(containerId);
                cont.innerHTML = `<div class="kolom-pasangan" id="left-${setId}">
                                    <h3 style="background:#f9a826;padding:10px;border-radius:30px;">‚¨ÖÔ∏è Kiri (tarik)</h3>
                                    <div id="left-${setId}-list"></div>
                                  </div>
                                  <div class="kolom-pasangan" id="right-${setId}">
                                    <h3 style="background:#6ab04c;padding:10px;border-radius:30px;">‚û°Ô∏è Kanan (lepas)</h3>
                                    <div id="right-${setId}-list"></div>
                                  </div>`;
                const leftList = document.getElementById(`left-${setId}-list`);
                const rightList = document.getElementById(`right-${setId}-list`);
                window[`pairMap${setId}`] = {};
                pairs.forEach(p => { window[`pairMap${setId}`][p.left] = p.right; });
                leftItems.forEach((txt, i) => {
                    let div = document.createElement('div');
                    div.className = 'pair-item-left';
                    div.id = `left-${setId}-${i}`;
                    div.innerHTML = txt;
                    div.setAttribute('data-left-text', txt);
                    div.setAttribute('data-left-idx', i);
                    div.setAttribute('data-set', setId);
                    div.addEventListener('pointerdown', dragStartHandler);
                    leftList.appendChild(div);
                });
                rightItems.forEach((txt, i) => {
                    let div = document.createElement('div');
                    div.className = 'pair-item-right';
                    div.id = `right-${setId}-${i}`;
                    div.innerHTML = txt;
                    div.setAttribute('data-right-text', txt);
                    div.setAttribute('data-right-idx', i);
                    div.setAttribute('data-set', setId);
                    div.addEventListener('pointerup', dropHandler);
                    div.addEventListener('pointerenter', dragEnterHandler);
                    rightList.appendChild(div);
                });
            }

            function dragStartHandler(e) {
                e.preventDefault();
                if (dragActive) return;
                draggedElement = this;
                draggedSet = this.getAttribute('data-set');
                draggedLeftIdx = parseInt(this.getAttribute('data-left-idx'));
                ghost.textContent = this.textContent;
                ghost.style.display = 'block';
                updateGhostPosition(e);
                this.classList.add('dragging');
                dragActive = true;
                window.addEventListener('pointermove', dragMoveHandler);
                window.addEventListener('pointerup', dragEndHandler);
                window.addEventListener('pointercancel', dragEndHandler);
            }
            function dragMoveHandler(e) {
                if (!dragActive) return;
                e.preventDefault();
                updateGhostPosition(e);
            }
            function dragEnterHandler(e) {
                if (!dragActive) return;
                e.preventDefault();
            }
            function dropHandler(e) {
                if (!dragActive) return;
                e.preventDefault();
                const rightSet = this.getAttribute('data-set');
                const rightText = this.getAttribute('data-right-text');
                if (rightSet !== draggedSet) { dragEndHandler(e); return; }
                const store = (draggedSet === 's1') ? pairSet1 : pairSet2;
                const prevRightText = store[draggedLeftIdx];
                if (prevRightText) {
                    draggedElement.classList.remove('paired');
                    const prevRightEls = document.querySelectorAll(`#right-${draggedSet} .pair-item-right`);
                    prevRightEls.forEach(el => {
                        if (el.getAttribute('data-right-text') === prevRightText) el.classList.remove('paired');
                    });
                }
                const rightEls = document.querySelectorAll(`#right-${draggedSet} .pair-item-right`);
                rightEls.forEach(el => {
                    if (el.getAttribute('data-right-text') === rightText) {
                        el.classList.remove('paired');
                        for (let key in store) {
                            if (store[key] === rightText) {
                                store[key] = null;
                                const leftEl = document.getElementById(`left-${draggedSet}-${key}`);
                                if (leftEl) leftEl.classList.remove('paired');
                            }
                        }
                    }
                });
                store[draggedLeftIdx] = rightText;
                draggedElement.classList.add('paired');
                this.classList.add('paired');
                dragEndHandler(e);
            }
            function updateGhostPosition(e) {
                let x, y;
                if (e.touches) {
                    x = e.touches[0].clientX;
                    y = e.touches[0].clientY;
                } else {
                    x = e.clientX;
                    y = e.clientY;
                }
                ghost.style.left = x + 'px';
                ghost.style.top = y + 'px';
            }
            function dragEndHandler(e) {
                if (!dragActive) return;
                e.preventDefault();
                ghost.style.display = 'none';
                if (draggedElement) draggedElement.classList.remove('dragging');
                window.removeEventListener('pointermove', dragMoveHandler);
                window.removeEventListener('pointerup', dragEndHandler);
                window.removeEventListener('pointercancel', dragEndHandler);
                dragActive = false;
                draggedElement = null;
                draggedSet = null;
                draggedLeftIdx = null;
            }

            renderDragDropSet('s1', set1Pairs, 'pasangan-set1');
            renderDragDropSet('s2', set2Pairs, 'pasangan-set2');

            // ========== TIMER ==========
            const TOTAL_SOAL = 70;
            const TIME_MINUTES = Math.floor(TOTAL_SOAL * 0.8);
            let timeLeft = TIME_MINUTES * 60;
            const timerDisplay = document.getElementById('timerDisplay');
            let timerInterval = setInterval(function() {
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    timerDisplay.textContent = "00:00";
                    document.getElementById('submitGlobalBtn').click();
                } else {
                    timeLeft--;
                    let minutes = Math.floor(timeLeft / 60);
                    let seconds = timeLeft % 60;
                    timerDisplay.textContent = `${minutes.toString().padStart(2,'0')}:${seconds.toString().padStart(2,'0')}`;
                }
            }, 1000);

            // ========== EVALUASI GLOBAL (target 80%) ==========
            window.evaluasiGlobal = function() {
                let totalBenar = 0;
                const totalSoal = 70;

                // 1. Âà§Êñ≠ÂØπÈîô
                for (let i=0; i<10; i++) {
                    const user = bsUserAnswers[i];
                    const correct = bsData[i].jawaban;
                    const parent = document.querySelector(`[data-bs="${i}"]`);
                    if (parent) {
                        const btns = parent.querySelectorAll('.btn-bs');
                        btns.forEach(b => b.classList.remove('benar','salah'));
                        if (user) {
                            const selectedBtn = document.getElementById(`bs-${i}-${user}`);
                            if (user === correct) { totalBenar++; selectedBtn.classList.add('benar'); }
                            else selectedBtn.classList.add('salah');
                        }
                    }
                }

                // 2. Listening
                for (let i=0; i<10; i++) {
                    const user = listeningUserAnswers[i];
                    const correct = listeningData[i].jawaban;
                    const parent = document.querySelector(`[data-listen="${i}"]`);
                    if (parent) {
                        const btns = parent.querySelectorAll('.btn-opsi');
                        btns.forEach(b => b.classList.remove('benar','salah'));
                        if (user) {
                            const selectedBtn = document.getElementById(`listen-${i}-${user}`);
                            if (user === correct) { totalBenar++; selectedBtn.classList.add('benar'); }
                            else selectedBtn.classList.add('salah');
                        }
                    }
                }

                // 3. Pilihan Ganda
                for (let i=0; i<10; i++) {
                    const user = pgUserAnswers[i];
                    const correct = pgData[i].jawab;
                    const parent = document.querySelector(`[data-pg="${i}"]`);
                    if (parent) {
                        const btns = parent.querySelectorAll('.btn-pilih');
                        btns.forEach(b => b.classList.remove('benar','salah'));
                        if (user) {
                            btns.forEach(b => {
                                if (b.innerText.startsWith(user.toUpperCase()+'.')) {
                                    if (user === correct) { totalBenar++; b.classList.add('benar'); }
                                    else b.classList.add('salah');
                                }
                            });
                        }
                    }
                }

                // 4. Isian Hanzi
                for (let i=0; i<10; i++) {
                    const inp = document.getElementById(`isian-${i}`);
                    if (inp) {
                        inp.classList.remove('benar','salah');
                        const userAns = inp.value.trim();
                        const correct = inp.dataset.jawaban;
                        if (userAns === correct) { totalBenar++; inp.classList.add('benar'); }
                        else if (userAns !== '') inp.classList.add('salah');
                    }
                }

                // 5. Mengetik Hanzi
                for (let i=0; i<10; i++) {
                    const inp = document.getElementById(`hanziInput${i}`);
                    const correct = hanziFromPinyin[i].hanzi;
                    inp.classList.remove('benar','salah');
                    if (inp.value.trim() === correct) { totalBenar++; inp.classList.add('benar'); }
                    else if (inp.value.trim() !== '') inp.classList.add('salah');
                }

                // 6. Indonesia ‚Üí Hanzi
                for (let i=0; i<10; i++) {
                    const inp = document.getElementById(`indoInput${i}`);
                    const correct = indoToHanzi[i].hanzi;
                    inp.classList.remove('benar','salah');
                    if (inp.value.trim() === correct) { totalBenar++; inp.classList.add('benar'); }
                    else if (inp.value.trim() !== '') inp.classList.add('salah');
                }

                // 7. Menjodohkan set1
                for (let leftIdx=0; leftIdx<5; leftIdx++) {
                    const leftEl = document.getElementById(`left-s1-${leftIdx}`);
                    if (!leftEl) continue;
                    const leftText = leftEl.getAttribute('data-left-text');
                    const rightText = pairSet1[leftIdx];
                    leftEl.classList.remove('benar','salah');
                    if (rightText) {
                        const correctRight = window.pairMaps1[leftText];
                        const rightEls = document.querySelectorAll(`#right-s1 .pair-item-right`);
                        rightEls.forEach(el => el.classList.remove('benar','salah'));
                        if (rightText === correctRight) { 
                            totalBenar++; 
                            leftEl.classList.add('benar'); 
                            rightEls.forEach(el => {
                                if (el.getAttribute('data-right-text') === rightText) el.classList.add('benar');
                            });
                        } else {
                            leftEl.classList.add('salah');
                            rightEls.forEach(el => {
                                if (el.getAttribute('data-right-text') === rightText) el.classList.add('salah');
                            });
                        }
                    }
                }
                // set2
                for (let leftIdx=0; leftIdx<5; leftIdx++) {
                    const leftEl = document.getElementById(`left-s2-${leftIdx}`);
                    if (!leftEl) continue;
                    const leftText = leftEl.getAttribute('data-left-text');
                    const rightText = pairSet2[leftIdx];
                    leftEl.classList.remove('benar','salah');
                    if (rightText) {
                        const correctRight = window.pairMaps2[leftText];
                        const rightEls = document.querySelectorAll(`#right-s2 .pair-item-right`);
                        rightEls.forEach(el => el.classList.remove('benar','salah'));
                        if (rightText === correctRight) { 
                            totalBenar++; 
                            leftEl.classList.add('benar'); 
                            rightEls.forEach(el => {
                                if (el.getAttribute('data-right-text') === rightText) el.classList.add('benar');
                            });
                        } else {
                            leftEl.classList.add('salah');
                            rightEls.forEach(el => {
                                if (el.getAttribute('data-right-text') === rightText) el.classList.add('salah');
                            });
                        }
                    }
                }

                const persen = (totalBenar / totalSoal * 100).toFixed(1);
                const lulus = persen >= 80 ? 'üéâ LULUS (‚â•80%)' : '‚ùå BELUM LULUS (target 80%)';
                const laporanDiv = document.getElementById('laporanGlobal');
                laporanDiv.style.display = 'block';
                let reviewButton = '';
                if (persen >= 80) {
                    reviewButton = '<button id="reviewBtn" class="btn-review" onclick="window.scrollTo({top: 0, behavior: \'smooth\'});"><i class="fas fa-search"></i> Review Soal</button>';
                }
                laporanDiv.innerHTML = `<h2><i class="fas fa-clipboard-check"></i> HASIL AKHIR</h2>
                    <p style="font-size:2.5rem; margin:20px 0;">${totalBenar} / ${totalSoal} = ${persen}%</p>
                    <p style="font-size:2rem; background: ${persen>=80?'#6ab04c':'#ff6b6b'}; padding:15px; border-radius:60px;">${lulus}</p>
                    ${reviewButton}`;
                clearInterval(timerInterval);
            };
            document.getElementById('submitGlobalBtn').addEventListener('click', evaluasiGlobal);
            window.pairMaps1 = {}; set1Pairs.forEach(p => { window.pairMaps1[p.left] = p.right; });
            window.pairMaps2 = {}; set2Pairs.forEach(p => { window.pairMaps2[p.left] = p.right; });
        })();
    </script>

    <script>
        document.addEventListener('contextmenu', e => e.preventDefault());
        document.addEventListener('copy', e => e.preventDefault());
        document.addEventListener('cut', e => e.preventDefault());
        document.addEventListener('selectstart', e => e.preventDefault());
        document.addEventListener('dragstart', e => e.preventDefault());
    </script>
</body>
</html>